<!DOCTYPE html>
<html>

  <head>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous">
    <!-- <link rel="stylesheet" href="style.css"> -->
    <title>Centroid</title>
    <script type="text/javascript" src="https://code.jquery.com/jquery-1.10.2.min.js"></script>
    <script type="text/javascript" src="https://maps.google.com/maps/api/js?sensor=false&libraries=places"></script>
    <script type="text/javascript" src="https://rawgit.com/Logicify/jquery-locationpicker-plugin/master/dist/locationpicker.jquery.js"></script>
    <script src="script.js"></script>
  </head>

  <body>
    <div class="container-fluid bg-dark text-light py-3">
        <header class="text-center">
            <h1 class="display-6">Ground Personnel Tracking</h1>
        </header>
    </div> <br />
    <div>
        <h4 class="headerOfCentroid" style="text-align: center;">Select your desired location to be safe guarded</h4>
        <br />
    </div>
    <div id="form" method="post" style="margin-left: 15%; margin-right: 15%;">
    <!-- Location: <input type="text" id="location" style="width: 200px"/> -->
    Latitude: <input type="text" id="lat" style="width: 200px" placeholder="lat"/>
    Longitude: <input type="text" id="lng" style="width: 200px" placeholder="lng"/>
    <a>
        <button type="submit" onclick="addCoordinates()">Add</button>     
    </a>
    <!-- Radius(in metres): <input type="number" id="rad" style="width: 200px; margin: auto;" placeholder="rad"><br /> -->
    <!-- <a href="./servicement.html">
        <input type="submit" value="Submit" />     
    </a> -->
    <a>
        <button type="submit" onclick="submitCoorinates()">Submit</button>
    </a>
    

    </div><br />
    
    <div id="us2" style="width: 70%; height:500px; margin: auto;"></div> 
  </body>
  <script>
    
    const multiCoords=[];
    
    
    var form = document.getElementById('form')
    form.addEventListener('submit',function(e){
        /*
        e.preventDefault()
        var lat = parseFloat(document.getElementById('lat').value)
        var lng = parseFloat(document.getElementById('lng').value)
        */


        // var rad = parseFloat(document.getElementById('rad').value)
        fetch("http://3.89.24.93:8090/api/passCoordinates",{
            method:'POST',
            // mode:"no-cors",
            body:JSON.stringify({
                latitude: lat,
                longitude: lng,
                radius: rad
            }),
            // headers:headers
            headers:{
                'Access-Control-Allow-Origin': '*',
                'Access-Control-Allow-Methods' : 'GET, POST, PUT, DELETE, OPTIONS',
                'Access-Control-Allow-Headers': 'Content-Type',
                'Content-Type':'application/json; charset=UTF-8',
            }
        })
        .then(function(response){
            return response.json()
        })
        .then(function(data){
            console.log(data)
        })
    })
    
    
    function addCoordinates(){
        var lat = parseFloat(document.getElementById('lat').value);
        var lng = parseFloat(document.getElementById('lng').value);
        let object = {latitude:lat,longitude:lng};
        multiCoords.push(object);
        console.log("inside addCoordinates");
    }
    function submitCoorinates(){
        console.log("inside submitCoordinates");
        console.log(multiCoords);
        
        var lat = parseFloat(document.getElementById('lat').value)
        var lng = parseFloat(document.getElementById('lng').value)
        fetch('http://54.221.6.162:8090/api/passCoordinates',{
            method:'POST',
            body:JSON.stringify(multiCoords),
            headers:{
                'Access-Control-Allow-Origin': '*',
                'Access-Control-Allow-Methods' : 'GET, POST, PUT, DELETE, OPTIONS',
                'Access-Control-Allow-Headers': 'Content-Type',
                'Content-Type':'application/json; charset=UTF-8',
            }
        })
        .then(response => response.json())
        .then(data => {
            console.log(data);
        })
        .catch(error => console.error(error));
        
    }
  </script>

</html>